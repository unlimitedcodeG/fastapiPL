import requests
import json
from datetime import datetime

# Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥Âπ∂Ê†ºÂºèÂåñ
current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
## ÊõøÊç¢‰∏∫‰Ω†ÁöÑËá™ÂÆö‰πâÊú∫Âô®‰∫∫ÁöÑ webhook Âú∞ÂùÄ„ÄÇ
WEBHOOK_URL = (
    "https://open.feishu.cn/open-apis/bot/v2/hook/beb036b7-9947-4dd6-a05e-04222322fdc4"
)
## Â∞ÜÊ∂àÊÅØÂç°ÁâáÂÜÖÂÆπÁ≤òË¥¥Ëá≥Ê≠§Â§Ñ„ÄÇ
card_json = {
    "config": {},
    "i18n_elements": {
        "en_us": [
            {
                "tag": "column_set",
                "flex_mode": "none",
                "background_style": "default",
                "horizontal_spacing": "8px",
                "horizontal_align": "left",
                "columns": [
                    {
                        "tag": "column",
                        "width": "weighted",
                        "vertical_align": "top",
                        "vertical_spacing": "8px",
                        "background_style": "default",
                        "elements": [
                            {
                                "tag": "column_set",
                                "flex_mode": "none",
                                "background_style": "default",
                                "horizontal_spacing": "8px",
                                "horizontal_align": "left",
                                "columns": [
                                    {
                                        "tag": "column",
                                        "width": "auto",
                                        "vertical_align": "center",
                                        "vertical_spacing": "8px",
                                        "background_style": "default",
                                        "elements": [
                                            {
                                                "tag": "img",
                                                "img_key": "img_v2_136e4af5-9893-4f96-a52a-60bb9b6347cg",
                                                "preview": True,
                                                "scale_type": "crop_center",
                                                "size": "tiny",
                                                "alt": {
                                                    "tag": "plain_text",
                                                    "content": "",
                                                },
                                            }
                                        ],
                                    },
                                    {
                                        "tag": "column",
                                        "width": "weighted",
                                        "vertical_align": "top",
                                        "vertical_spacing": "8px",
                                        "background_style": "default",
                                        "elements": [
                                            {
                                                "tag": "column_set",
                                                "flex_mode": "none",
                                                "horizontal_spacing": "default",
                                                "background_style": "default",
                                                "columns": [
                                                    {
                                                        "tag": "column",
                                                        "elements": [
                                                            {
                                                                "tag": "div",
                                                                "text": {
                                                                    "tag": "plain_text",
                                                                    "content": "2023 Âπ¥ 11 Êúà 11 Êó• 10:00",
                                                                },
                                                            }
                                                        ],
                                                        "width": "weighted",
                                                        "weight": 1,
                                                    }
                                                ],
                                            }
                                        ],
                                        "weight": 1,
                                    },
                                ],
                            },
                            {
                                "tag": "column_set",
                                "flex_mode": "none",
                                "background_style": "default",
                                "horizontal_spacing": "8px",
                                "horizontal_align": "left",
                                "columns": [
                                    {
                                        "tag": "column",
                                        "width": "auto",
                                        "vertical_align": "center",
                                        "vertical_spacing": "8px",
                                        "background_style": "default",
                                        "elements": [
                                            {
                                                "tag": "img",
                                                "img_key": "img_v2_f9d63232-61ec-44f0-9fb7-bf8ba82ea92g",
                                                "preview": True,
                                                "scale_type": "crop_center",
                                                "size": "tiny",
                                                "alt": {
                                                    "tag": "plain_text",
                                                    "content": "",
                                                },
                                            }
                                        ],
                                    },
                                    {
                                        "tag": "column",
                                        "width": "weighted",
                                        "vertical_align": "top",
                                        "vertical_spacing": "8px",
                                        "background_style": "default",
                                        "elements": [
                                            {
                                                "tag": "column_set",
                                                "flex_mode": "none",
                                                "horizontal_spacing": "default",
                                                "background_style": "default",
                                                "columns": [
                                                    {
                                                        "tag": "column",
                                                        "elements": [
                                                            {
                                                                "tag": "div",
                                                                "text": {
                                                                    "tag": "plain_text",
                                                                    "content": "Âåó‰∫¨Â≠¶Ê∏ÖÂòâÂàõÂ§ßÂé¶ B Â∫ß F2-26",
                                                                },
                                                            }
                                                        ],
                                                        "width": "weighted",
                                                        "weight": 1,
                                                    }
                                                ],
                                            }
                                        ],
                                        "weight": 1,
                                    },
                                ],
                            },
                        ],
                        "weight": 1,
                    },
                    {
                        "tag": "column",
                        "width": "auto",
                        "vertical_align": "center",
                        "vertical_spacing": "8px",
                        "background_style": "default",
                        "elements": [
                            {
                                "tag": "button",
                                "text": {"tag": "plain_text", "content": "üî•Á´ãÂç≥Êü•Áúã"},
                                "type": "laser",
                                "complex_interaction": True,
                            }
                        ],
                    },
                ],
            },
            {
                "tag": "img",
                "img_key": "img_v2_609930d7-21cc-475a-baba-3de5dafe079g",
                "preview": True,
                "scale_type": "fit_horizontal",
                "alt": {"tag": "plain_text", "content": ""},
            },
        ],
        "zh_cn": [
            {
                "tag": "img",
                "img_key": "img_v3_02bu_55631821-5541-4ebc-b4fe-ae5ee14ff09g",
                "preview": True,
                "scale_type": "crop_center",
                "size": "stretch_without_padding",
                "alt": {"tag": "plain_text", "content": ""},
            },
            {
                "tag": "markdown",
                "content": "ÊÄßËÉΩÊµãËØïÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÂêÑ‰ΩçÂèØ‰ª•ÁúãÂà∞ËøôÊ¨°Âø´ÈÄüÊØîÂØπÁöÑÂÜÖÂÆπ",
                "text_align": "left",
                "text_size": "normal",
            },
            {
                "tag": "column_set",
                "flex_mode": "none",
                "background_style": "default",
                "horizontal_spacing": "8px",
                "horizontal_align": "left",
                "columns": [
                    {
                        "tag": "column",
                        "width": "weighted",
                        "vertical_align": "top",
                        "vertical_spacing": "8px",
                        "background_style": "default",
                        "elements": [
                            {
                                "tag": "markdown",
                                "content": f"**ÊØîÂØπÂÆåÊàêÊó∂Èó¥{current_time}**",
                                "text_align": "left",
                                "text_size": "normal",
                                "icon": {
                                    "tag": "standard_icon",
                                    "token": "time_outlined",
                                    "color": "grey",
                                },
                            }
                        ],
                        "weight": 1,
                    },
                    {
                        "tag": "column",
                        "width": "weighted",
                        "vertical_align": "top",
                        "vertical_spacing": "8px",
                        "background_style": "default",
                        "elements": [
                            {
                                "tag": "column_set",
                                "flex_mode": "none",
                                "horizontal_spacing": "default",
                                "background_style": "default",
                                "columns": [
                                    {
                                        "tag": "column",
                                        "elements": [
                                            {
                                                "tag": "div",
                                                "text": {
                                                    "tag": "plain_text",
                                                    "content": "jenkins-workFlow",
                                                    "text_size": "normal",
                                                    "text_align": "left",
                                                    "text_color": "default",
                                                },
                                                "icon": {
                                                    "tag": "standard_icon",
                                                    "token": "collection_outlined",
                                                    "color": "grey",
                                                },
                                            }
                                        ],
                                        "width": "weighted",
                                        "weight": 1,
                                    }
                                ],
                            }
                        ],
                        "weight": 1,
                    },
                ],
                "margin": "16px 0px 0px 0px",
            },
            {
                "tag": "action",
                "actions": [
                    {
                        "tag": "button",
                        "text": {"tag": "plain_text", "content": "üå†ÂéªjenkinsÊü•Áúã"},
                        "type": "laser",
                        "complex_interaction": True,
                        "size": "medium",
                        "multi_url": {
                            "url": "https://bytedance.larkoffice.com/wiki/BG4XwdGyFiC9EikdJmQc5ozinOd",
                            "pc_url": "",
                            "ios_url": "",
                            "android_url": "",
                        },
                    }
                ],
            },
            {
                "tag": "note",
                "elements": [
                    {"tag": "standard_icon", "token": "robot-add_outlined"},
                    {"tag": "plain_text", "content": "Â¶ÇÊúâÁñëÈóÆÔºåËØ∑Âí®ËØ¢ÂàòÊ≥ì‰∏éÂΩ≠ÁæéÈúñ"},
                ],
            },
        ],
    },
    "i18n_header": {
        # "en_us": {
        #     "title": {"tag": "plain_text", "content": "ÂçÅÂë®Âπ¥Â∫ÜÂÖ∏"},
        #     "subtitle": {"tag": "plain_text", "content": ""},
        #     "template": "default",
        #     "icon": {
        #         "tag": "custom_icon",
        #         "img_key": "img_v2_1bfeb6af-dd10-4e49-8fd2-5a392bc86ccg",
        #     },
        # },
        "zh_cn": {
            "title": {
                "tag": "plain_text",
                "content": "ÂàõÊ∏∏‰∏ñÁïåÊÄßËÉΩÊµãËØïÂø´ÈÄüÂØπÊØîÁªìÊùüÔºåÂø´Êù•Êü•ÁúãÊµãËØïÁªìÊûúÂêßÔºÅ",
            },
            "subtitle": {"tag": "plain_text", "content": ""},
            "template": "blue",
            "icon": {
                "tag": "custom_icon",
                "img_key": "img_v3_02bu_52d0119c-f2f1-4e5b-bacd-2ea2651cca7g",
            },
        },
    },
}
body = json.dumps({"msg_type": "interactive", "card": card_json})
print(body)
print("sad ")
headers = {"Content-Type": "application/json"}
res = requests.post(url=WEBHOOK_URL, data=body, headers=headers)
print(res.request.body)
print(res.text)
